//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated from a template.
//     Changes to this file may cause incorrect behavior and will be lost if the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------
// Copyright (c) Matthieu MEZIL.  All rights reserved.
// matthieu.mezil@live.fr

 
using System;
using System.Collections.Generic;
using System.Linq.Expressions;
using WAQS.Service.Interfaces;
using WAQS.SerializableExpressions;

namespace WAQS.Service
{
    public class SerializableExpressionProvider : ISerializableExpressionProvider
    {
        private Func<SerializableExpression, IEnumerable<string>, Expression> _expressionConverter;
        private Func<object, object> _convert;
        private Func<Type, Type> _getOriginalType;
        
        public SerializableExpressionProvider(Func<SerializableExpression, IEnumerable<string>, Expression> expressionConverter, Func<object, object> convert, Func<Type, Type> getOriginalType)
        {
            _expressionConverter = expressionConverter;
            _convert = convert;
            _getOriginalType = getOriginalType;
        }
        
        public Expression ToExpression(SerializableExpression serializableExpression, IEnumerable<string> withSpecificationsProperties)
        {
            return _expressionConverter(serializableExpression, withSpecificationsProperties);
        }
    
        public virtual Type GetOriginalType(Type type)
        {
            return _getOriginalType(type);
        }
    
        public virtual object Convert(object p)
        {
            if (p == null)
                return null;
            return _convert(p);
        }
    }
}
